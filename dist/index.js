(()=>{"use strict";const e=[{x:0,y:-1,name:"⇐"},{x:-1,y:0,name:"⇑"},{x:0,y:1,name:"⇒"},{x:1,y:0,name:"⇓"}],t={currentState:null,moves:0,settled:0,dropped:0,depth:0,haveSolution:!1},n=(e,t,n=!0)=>{console.log(`Index of the state ${t}`);let o="";for(let t of e){const e=t.map((e=>e||" "));o+="-------------\n",o+=`| ${e[0]} | ${e[1]} | ${e[2]} |\n`}return o+="-------------\n",n&&console.log(o),o},o=e=>{let t={x:0,y:0,name:"empty"};e:for(let n=0;n<e[0].length;++n)for(let o=0;o<e.length;++o)if(null===e[n][o]){t.x=n,t.y=o;break e}return t},l=e=>e.x>=3||e.x<0||e.y>=3||e.y<0;class s{constructor(e,t,o,l,s){this.getState=()=>this.state,this.getMoves=()=>this.operator,this.getDepth=()=>this.depth||1,this.pathFromStart=()=>{let e=[],t=[],o=this;console.log(o.getDepth());do{e.push(o?.getState()),t.push(o?.getMoves()),o=o?.parent}while(o?.getDepth());e.reverse(),t.reverse();let l=1;for(const t of e)n(t,l),l++;return console.log(`Кількість переміщень: ${t.length}`),console.log(`Переміщення по порядку: ${t.join(", ")}\n`),t},this.state=e,this.parent=t,this.operator=o,this.depth=l,this.cost=s}}let r=t;(()=>{let a=[];const d=document.querySelector(".next"),c=document.querySelector(".result"),i=document.querySelector(".find"),p=document.getElementById("result-content");let h=0;const u=document.getElementById("results");d.disabled=!0,c.disabled=!0,d?.addEventListener("click",(()=>{h>=a.length-1&&(d.disabled=!0);const e=document.createElement("table");e.className+="table table-primary table-hover table-bordered table-sm align-middle caption-top",e.style.width="200px",e.style.height="200px",e.style.textAlign="center",e.insertAdjacentHTML("afterbegin",`\n            <caption class="fw-bold text-primary">\n               Index of the state is ${a[h].index}\n            </caption>\n         `);const t=document.createElement("tbody");for(let e of a[h].state){const n=t.insertRow();for(let t of e){const e=n.insertCell();e.classList.add("align-middle"),e.innerHTML=t?String(t):" "}}e.appendChild(t),u?.appendChild(e),u.scrollTop=u.scrollHeight,n(a[h].state,a[h].index),h++})),c?.addEventListener("click",(()=>{p.innerHTML="",r.haveSolution?(console.log("Порядок переміщень для розв'язку гри в 8:"),r?.currentState?.pathFromStart(),console.log(`Кількість відвіданих станів: ${r.moves}`),console.log(`Кількість станів занесених у БД: ${r.settled}`),console.log(`Кількість відкинутих станів: ${r.dropped}`),console.log(`Глибина дерева пошуку на якій знайдено рішення: ${r.depth}`),p.insertAdjacentHTML("beforeend",`\n            <code>\n            <pre>Кількість відвіданих станів: ${r.moves}<br>Кількість станів занесених у БД: ${r.settled}<br>Кількість відкинутих станів: ${r.dropped}<br>Глибина дерева пошуку на якій знайдено рішення: ${r.depth}</pre>\n            </code>\n         `)):(console.log(`Кількість відвіданих станів: ${r.moves}`),console.log(`Кількість станів занесених у БД: ${r.settled}`),console.log(`Кількість відкинутих станів: ${r.dropped}`),console.log("Гра у 8 немає розв'язків"),p.insertAdjacentHTML("beforeend",`\n            <code>\n            <pre>Кількість відвіданих станів : ${r.moves}<br>Кількість станів занесених у БД : ${r.settled}<br>Кількість відкинутих станів : ${r.dropped}<br>Гра у 8 немає розв'язків</pre>\n            </code>\n         `))})),i?.addEventListener("click",(()=>{const n=e=>{const t=[];for(let n of e.rows){const e=[];for(let t of n.cells){const n=parseInt(t.innerHTML);Number.isNaN(n)?e.push(null):e.push(n)}t.push(e)}return t},i=document.querySelector(".initial-state"),p=document.querySelector(".final-state"),g=n(i),m=n(p);h=0,r=t,u.innerHTML=null;const y=new Map;y.set(g.toString(),!0);const f=[new s(g,null,null,0,0)];a=function(t,n,a,d){for(;d.length;){let i=d.pop();if(r={...r,currentState:i,settled:a.size,depth:i.getDepth(),haveSolution:!1},c=t,i.getState()?.toString()===c?.toString())return r.haveSolution=!0,n;const p=o(i.getState());e.forEach((e=>{const t=i?.getState()?.map((e=>[...e])),o={x:p.x+e.x,y:p.y+e.y,name:e.name};l(o)||([t[p.x][p.y],t[o.x][o.y]]=[t[o.x][o.y],t[p.x][p.y]],r.moves++,a.get(t.toString())?r.dropped++:(d.push(new s(t,i,e.name,i.getDepth()+1,0)),a.set(t.toString(),!0),n.push({state:t,index:r.moves+1})))}))}var c;return n}(m,[{state:g,index:1}],y,f),d.disabled=!1,c.disabled=!1}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Oi8vbGFiMS8uL3NyYy9oZWxwZXJzLnRzIiwid2VicGFjazovL2xhYjEvLi9zcmMvbm9kZS50cyIsIndlYnBhY2s6Ly9sYWIxLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBmaW5hbFN0YXRlID0gW1xyXG4gICAgWzEsIDIsIDNdLFxyXG4gICAgWzQsIDUsIDZdLFxyXG4gICAgWzcsIDgsIG51bGxdLFxyXG5dO1xyXG5leHBvcnQgY29uc3QgZGlyZWN0aW9ucyA9IFtcclxuICAgIHsgeDogMCwgeTogLTEsIG5hbWU6IFwi4oeQXCIgfSxcclxuICAgIHsgeDogLTEsIHk6IDAsIG5hbWU6IFwi4oeRXCIgfSxcclxuICAgIHsgeDogMCwgeTogMSwgbmFtZTogXCLih5JcIiB9LFxyXG4gICAgeyB4OiAxLCB5OiAwLCBuYW1lOiBcIuKHk1wiIH0sXHJcbl07XHJcbmV4cG9ydCBjb25zdCBDTEVBTl9SRVNVTFQgPSB7XHJcbiAgICBjdXJyZW50U3RhdGU6IG51bGwsXHJcbiAgICBtb3ZlczogMCxcclxuICAgIHNldHRsZWQ6IDAsXHJcbiAgICBkcm9wcGVkOiAwLFxyXG4gICAgZGVwdGg6IDAsXHJcbiAgICBoYXZlU29sdXRpb246IGZhbHNlLFxyXG59O1xyXG4iLCJleHBvcnQgZnVuY3Rpb24qIGdldEV4ZWN1dGlvblRpbWUoKSB7XHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgeWllbGQgMTtcclxuICAgIGNvbnN0IGVuZFRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgZGlmZiA9IG5ldyBEYXRlKGVuZFRpbWUgLSBzdGFydFRpbWUpO1xyXG4gICAgY29uc3QgZXhlY3V0aW9uID0gZGlmZi5nZXRTZWNvbmRzKCkgKyAwLjAwMSAqIGRpZmYuZ2V0TWlsbGlzZWNvbmRzKCk7XHJcbiAgICBjb25zb2xlLmxvZyhgRXhlY3V0aW9uIHRpbWU6ICR7ZXhlY3V0aW9ufSBzZWNvbmRzYCk7XHJcbn1cclxuZXhwb3J0IGNvbnN0IGRpc3BsYXlCb2FyZCA9IChzdGF0ZSwgaW5kZXgsIGRlYnVnID0gdHJ1ZSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYEluZGV4IG9mIHRoZSBzdGF0ZSAke2luZGV4fWApO1xyXG4gICAgbGV0IGRpc3BsYXkgPSBcIlwiO1xyXG4gICAgZm9yIChsZXQgcm93IG9mIHN0YXRlKSB7XHJcbiAgICAgICAgY29uc3QgY2VsbHMgPSByb3cubWFwKChpdGVtKSA9PiAoIWl0ZW0gPyBcIiBcIiA6IGl0ZW0pKTtcclxuICAgICAgICBkaXNwbGF5ICs9IFwiLS0tLS0tLS0tLS0tLVxcblwiO1xyXG4gICAgICAgIGRpc3BsYXkgKz0gYHwgJHtjZWxsc1swXX0gfCAke2NlbGxzWzFdfSB8ICR7Y2VsbHNbMl19IHxcXG5gO1xyXG4gICAgfVxyXG4gICAgZGlzcGxheSArPSBcIi0tLS0tLS0tLS0tLS1cXG5cIjtcclxuICAgIGlmIChkZWJ1ZylcclxuICAgICAgICBjb25zb2xlLmxvZyhkaXNwbGF5KTtcclxuICAgIHJldHVybiBkaXNwbGF5O1xyXG59O1xyXG5leHBvcnQgY29uc3QgZ2V0RW1weUNlbGxDb29yZHMgPSAoc3RhdGUpID0+IHtcclxuICAgIGxldCBjb29yZGluYXRlcyA9IHsgeDogMCwgeTogMCwgbmFtZTogXCJlbXB0eVwiIH07XHJcbiAgICBvdXRlcjogZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZVswXS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc3RhdGUubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgaWYgKHN0YXRlW2ldW2pdID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb29yZGluYXRlcy54ID0gaTtcclxuICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLnkgPSBqO1xyXG4gICAgICAgICAgICAgICAgYnJlYWsgb3V0ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29vcmRpbmF0ZXM7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBzdGF0ZXNBcmVFcXVhbCA9IChzdGF0ZSwgc2Vjb25kU3RhdGUpID0+IHtcclxuICAgIHJldHVybiBzdGF0ZT8udG9TdHJpbmcoKSA9PT0gc2Vjb25kU3RhdGU/LnRvU3RyaW5nKCk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBpc091dE9mQm9yZGVyID0gKGNvb3JkcykgPT4ge1xyXG4gICAgaWYgKGNvb3Jkcy54ID49IDMgfHwgY29vcmRzLnggPCAwKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgaWYgKGNvb3Jkcy55ID49IDMgfHwgY29vcmRzLnkgPCAwKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG4iLCJpbXBvcnQgeyBkaXNwbGF5Qm9hcmQgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XHJcbmV4cG9ydCBjbGFzcyBOb2RlIHtcclxuICAgIGNvbnN0cnVjdG9yKHN0YXRlLCBwYXJlbnQsIG9wZXJhdG9yLCBkZXB0aCwgY29zdCkge1xyXG4gICAgICAgIHRoaXMuZ2V0U3RhdGUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXRlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRNb3ZlcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3BlcmF0b3I7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldERlcHRoID0gKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZXB0aCB8fCAxO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5wYXRoRnJvbVN0YXJ0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgc3RhdGVMaXN0ID0gW107XHJcbiAgICAgICAgICAgIGxldCBtb3ZlTGlzdCA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudE5vZGUgPSB0aGlzO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50Tm9kZS5nZXREZXB0aCgpKTtcclxuICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgc3RhdGVMaXN0LnB1c2goY3VycmVudE5vZGU/LmdldFN0YXRlKCkpO1xyXG4gICAgICAgICAgICAgICAgbW92ZUxpc3QucHVzaChjdXJyZW50Tm9kZT8uZ2V0TW92ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlPy5wYXJlbnQ7XHJcbiAgICAgICAgICAgIH0gd2hpbGUgKGN1cnJlbnROb2RlPy5nZXREZXB0aCgpKTtcclxuICAgICAgICAgICAgc3RhdGVMaXN0LnJldmVyc2UoKTtcclxuICAgICAgICAgICAgbW92ZUxpc3QucmV2ZXJzZSgpO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSAxO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygc3RhdGVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Qm9hcmQoaXRlbSwgaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINC/0LXRgNC10LzRltGJ0LXQvdGMOiAke21vdmVMaXN0Lmxlbmd0aH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCf0LXRgNC10LzRltGJ0LXQvdC90Y8g0L/QviDQv9C+0YDRj9C00LrRgzogJHttb3ZlTGlzdC5qb2luKFwiLCBcIil9XFxuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBtb3ZlTGlzdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcclxuICAgICAgICB0aGlzLm9wZXJhdG9yID0gb3BlcmF0b3I7XHJcbiAgICAgICAgdGhpcy5kZXB0aCA9IGRlcHRoO1xyXG4gICAgICAgIHRoaXMuY29zdCA9IGNvc3Q7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ0xFQU5fUkVTVUxULCBkaXJlY3Rpb25zIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IGRpc3BsYXlCb2FyZCwgZ2V0RW1weUNlbGxDb29yZHMsIGlzT3V0T2ZCb3JkZXIsIHN0YXRlc0FyZUVxdWFsLCB9IGZyb20gXCIuL2hlbHBlcnNcIjtcclxuaW1wb3J0IHsgTm9kZSB9IGZyb20gXCIuL25vZGVcIjtcclxubGV0IHJlc3VsdHMgPSBDTEVBTl9SRVNVTFQ7XHJcbmNvbnN0IERGUyA9IGZ1bmN0aW9uIChmaW5hbCwgc3RhdGVzLCBkYiwgcXVldWUpIHtcclxuICAgIHdoaWxlIChxdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgY3VycmVudFN0YXRlID0gcXVldWUucG9wKCk7XHJcbiAgICAgICAgcmVzdWx0cyA9IHtcclxuICAgICAgICAgICAgLi4ucmVzdWx0cyxcclxuICAgICAgICAgICAgY3VycmVudFN0YXRlOiBjdXJyZW50U3RhdGUsXHJcbiAgICAgICAgICAgIHNldHRsZWQ6IGRiLnNpemUsXHJcbiAgICAgICAgICAgIGRlcHRoOiBjdXJyZW50U3RhdGUuZ2V0RGVwdGgoKSxcclxuICAgICAgICAgICAgaGF2ZVNvbHV0aW9uOiBmYWxzZSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChzdGF0ZXNBcmVFcXVhbChjdXJyZW50U3RhdGUuZ2V0U3RhdGUoKSwgZmluYWwpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMuaGF2ZVNvbHV0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZW1wdHlDZWxsID0gZ2V0RW1weUNlbGxDb29yZHMoY3VycmVudFN0YXRlLmdldFN0YXRlKCkpO1xyXG4gICAgICAgIGRpcmVjdGlvbnMuZm9yRWFjaCgoZGlyZWN0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvcHlTdGF0ZSA9IGN1cnJlbnRTdGF0ZVxyXG4gICAgICAgICAgICAgICAgPy5nZXRTdGF0ZSgpXHJcbiAgICAgICAgICAgICAgICA/Lm1hcCgocm93KSA9PiBbLi4ucm93XSk7XHJcbiAgICAgICAgICAgIC8vIGNvb3JkcyBjZWxsIHRvIHN3aXRjaFxyXG4gICAgICAgICAgICBjb25zdCBjb29yZHMgPSB7XHJcbiAgICAgICAgICAgICAgICB4OiBlbXB0eUNlbGwueCArIGRpcmVjdGlvbi54LFxyXG4gICAgICAgICAgICAgICAgeTogZW1wdHlDZWxsLnkgKyBkaXJlY3Rpb24ueSxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGRpcmVjdGlvbi5uYW1lLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyBpZiBjb29yZHMgb2Ygc3dhcHBlZCBjZWxsIGlzIG5vdCBvdXQgdGhlIGJvcmRlciBvZiB0aGUgZmllbGRcclxuICAgICAgICAgICAgaWYgKCFpc091dE9mQm9yZGVyKGNvb3JkcykpIHtcclxuICAgICAgICAgICAgICAgIC8vIG1vdmUgZW1wdHkgY2VsbCBpbnRvIGN1cnJlbnQgZGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBbXHJcbiAgICAgICAgICAgICAgICAgICAgY29weVN0YXRlW2VtcHR5Q2VsbC54XVtlbXB0eUNlbGwueV0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29weVN0YXRlW2Nvb3Jkcy54XVtjb29yZHMueV0sXHJcbiAgICAgICAgICAgICAgICBdID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIGNvcHlTdGF0ZVtjb29yZHMueF1bY29vcmRzLnldLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvcHlTdGF0ZVtlbXB0eUNlbGwueF1bZW1wdHlDZWxsLnldLFxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMubW92ZXMrKztcclxuICAgICAgICAgICAgICAgIC8vIGlmIHN3YXBwZWQgc3RhdGUgaXMgbm90IHByZXNlbnQgaW4gZGF0YWJhc2VcclxuICAgICAgICAgICAgICAgIGlmICghZGIuZ2V0KGNvcHlTdGF0ZS50b1N0cmluZygpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2gobmV3IE5vZGUoY29weVN0YXRlLCBjdXJyZW50U3RhdGUsIGRpcmVjdGlvbi5uYW1lLCBjdXJyZW50U3RhdGUuZ2V0RGVwdGgoKSArIDEsIDApKTtcclxuICAgICAgICAgICAgICAgICAgICBkYi5zZXQoY29weVN0YXRlLnRvU3RyaW5nKCksIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlcy5wdXNoKHsgc3RhdGU6IGNvcHlTdGF0ZSwgaW5kZXg6IHJlc3VsdHMubW92ZXMgKyAxIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5kcm9wcGVkKys7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdGF0ZXM7XHJcbn07XHJcbigoKSA9PiB7XHJcbiAgICBsZXQgYWxsU3RhdGVzID0gW107XHJcbiAgICBjb25zdCBuZXh0U3RhdGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5leHRcIik7XHJcbiAgICBjb25zdCByZXN1bHRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc3VsdFwiKTtcclxuICAgIGNvbnN0IGZpbmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZpbmRcIik7XHJcbiAgICBjb25zdCByZXN1bHRDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHQtY29udGVudFwiKTtcclxuICAgIGxldCBpbmRleE9mTmV4dFN0YXRlID0gMDtcclxuICAgIGNvbnN0IHJlc3VsdHNXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzXCIpO1xyXG4gICAgY29uc3QgdW5sb2NrQnV0dG9ucyA9ICgpID0+IHtcclxuICAgICAgICBuZXh0U3RhdGVCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICByZXN1bHRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH07XHJcbiAgICBjb25zdCBkaXNhYmxlQnV0dG9ucyA9ICgpID0+IHtcclxuICAgICAgICBuZXh0U3RhdGVCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIHJlc3VsdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgY29uc3QgcHJpbnRSZXN1bHRzID0gKCkgPT4ge1xyXG4gICAgICAgIHJlc3VsdENvbnRlbnQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICBpZiAoIXJlc3VsdHMuaGF2ZVNvbHV0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LLRltC00LDQvdC40YUg0YHRgtCw0L3RltCyOiAke3Jlc3VsdHMubW92ZXN9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0YHRgtCw0L3RltCyINC30LDQvdC10YHQtdC90LjRhSDRgyDQkdCUOiAke3Jlc3VsdHMuc2V0dGxlZH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQutC40L3Rg9GC0LjRhSDRgdGC0LDQvdGW0LI6ICR7cmVzdWx0cy5kcm9wcGVkfWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcItCT0YDQsCDRgyA4INC90LXQvNCw0ZQg0YDQvtC30LIn0Y/Qt9C60ZbQslwiKTtcclxuICAgICAgICAgICAgcmVzdWx0Q29udGVudC5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgYFxuICAgICAgICAgICAgPGNvZGU+XG4gICAgICAgICAgICA8cHJlPtCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQstGW0LTQsNC90LjRhSDRgdGC0LDQvdGW0LIgOiAke3Jlc3VsdHMubW92ZXN9PGJyPtCa0ZbQu9GM0LrRltGB0YLRjCDRgdGC0LDQvdGW0LIg0LfQsNC90LXRgdC10L3QuNGFINGDINCR0JQgOiAke3Jlc3VsdHMuc2V0dGxlZH08YnI+0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNC60LjQvdGD0YLQuNGFINGB0YLQsNC90ZbQsiA6ICR7cmVzdWx0cy5kcm9wcGVkfTxicj7Qk9GA0LAg0YMgOCDQvdC10LzQsNGUINGA0L7Qt9CyJ9GP0LfQutGW0LI8L3ByZT5cbiAgICAgICAgICAgIDwvY29kZT5cbiAgICAgICAgIGApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLQn9C+0YDRj9C00L7QuiDQv9C10YDQtdC80ZbRidC10L3RjCDQtNC70Y8g0YDQvtC30LIn0Y/Qt9C60YMg0LPRgNC4INCyIDg6XCIpO1xyXG4gICAgICAgICAgICByZXN1bHRzPy5jdXJyZW50U3RhdGU/LnBhdGhGcm9tU3RhcnQoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQstGW0LTQsNC90LjRhSDRgdGC0LDQvdGW0LI6ICR7cmVzdWx0cy5tb3Zlc31gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDRgdGC0LDQvdGW0LIg0LfQsNC90LXRgdC10L3QuNGFINGDINCR0JQ6ICR7cmVzdWx0cy5zZXR0bGVkfWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNC60LjQvdGD0YLQuNGFINGB0YLQsNC90ZbQsjogJHtyZXN1bHRzLmRyb3BwZWR9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQk9C70LjQsdC40L3QsCDQtNC10YDQtdCy0LAg0L/QvtGI0YPQutGDINC90LAg0Y/QutGW0Lkg0LfQvdCw0LnQtNC10L3QviDRgNGW0YjQtdC90L3RjzogJHtyZXN1bHRzLmRlcHRofWApO1xyXG4gICAgICAgICAgICByZXN1bHRDb250ZW50Lmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBgXG4gICAgICAgICAgICA8Y29kZT5cbiAgICAgICAgICAgIDxwcmU+0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNCy0ZbQtNCw0L3QuNGFINGB0YLQsNC90ZbQsjogJHtyZXN1bHRzLm1vdmVzfTxicj7QmtGW0LvRjNC60ZbRgdGC0Ywg0YHRgtCw0L3RltCyINC30LDQvdC10YHQtdC90LjRhSDRgyDQkdCUOiAke3Jlc3VsdHMuc2V0dGxlZH08YnI+0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNC60LjQvdGD0YLQuNGFINGB0YLQsNC90ZbQsjogJHtyZXN1bHRzLmRyb3BwZWR9PGJyPtCT0LvQuNCx0LjQvdCwINC00LXRgNC10LLQsCDQv9C+0YjRg9C60YMg0L3QsCDRj9C60ZbQuSDQt9C90LDQudC00LXQvdC+INGA0ZbRiNC10L3QvdGPOiAke3Jlc3VsdHMuZGVwdGh9PC9wcmU+XG4gICAgICAgICAgICA8L2NvZGU+XG4gICAgICAgICBgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgY29uc3QgZmluZFJlc3VsdHMgPSAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZ2V0VGFibGVTdGF0ZSA9ICh0YWJsZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzdGF0ZSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCByb3cgb2YgdGFibGUucm93cykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhdGVSb3cgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGNlbGwgb2Ygcm93LmNlbGxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbERhdGEgPSBwYXJzZUludChjZWxsLmlubmVySFRNTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgTnVtYmVyLmlzTmFOKGNlbGxEYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHN0YXRlUm93LnB1c2gobnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzdGF0ZVJvdy5wdXNoKGNlbGxEYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXRlLnB1c2goc3RhdGVSb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxTdGF0ZVRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbml0aWFsLXN0YXRlXCIpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsU3RhdGVUYWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmluYWwtc3RhdGVcIik7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbCA9IGdldFRhYmxlU3RhdGUoaW5pdGlhbFN0YXRlVGFibGUpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsID0gZ2V0VGFibGVTdGF0ZShmaW5hbFN0YXRlVGFibGUpO1xyXG4gICAgICAgIC8vIHJlc2V0IHN0ZXAgYnkgc3RlcCByZXN1bHRzIG91dHB1dFxyXG4gICAgICAgIGluZGV4T2ZOZXh0U3RhdGUgPSAwO1xyXG4gICAgICAgIHJlc3VsdHMgPSBDTEVBTl9SRVNVTFQ7XHJcbiAgICAgICAgcmVzdWx0c1dyYXBwZXIuaW5uZXJIVE1MID0gbnVsbDtcclxuICAgICAgICBjb25zdCBkYiA9IG5ldyBNYXAoKTtcclxuICAgICAgICBkYi5zZXQoaW5pdGlhbC50b1N0cmluZygpLCB0cnVlKTtcclxuICAgICAgICBjb25zdCBxdWV1ZSA9IFtuZXcgTm9kZShpbml0aWFsLCBudWxsLCBudWxsLCAwLCAwKV07XHJcbiAgICAgICAgYWxsU3RhdGVzID0gREZTKGZpbmFsLCBbeyBzdGF0ZTogaW5pdGlhbCwgaW5kZXg6IDEgfV0sIGRiLCBxdWV1ZSk7XHJcbiAgICAgICAgdW5sb2NrQnV0dG9ucygpO1xyXG4gICAgfTtcclxuICAgIGRpc2FibGVCdXR0b25zKCk7XHJcbiAgICBuZXh0U3RhdGVCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGluZGV4T2ZOZXh0U3RhdGUgPj0gYWxsU3RhdGVzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgbmV4dFN0YXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQWRkIG5leHQgbmV3IHN0YXRlIHRhYmxlIHRvIHRoZSB2aWV3XHJcbiAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGFibGVcIik7XHJcbiAgICAgICAgdGFibGUuY2xhc3NOYW1lICs9XHJcbiAgICAgICAgICAgIFwidGFibGUgdGFibGUtcHJpbWFyeSB0YWJsZS1ob3ZlciB0YWJsZS1ib3JkZXJlZCB0YWJsZS1zbSBhbGlnbi1taWRkbGUgY2FwdGlvbi10b3BcIjtcclxuICAgICAgICB0YWJsZS5zdHlsZS53aWR0aCA9IFwiMjAwcHhcIjtcclxuICAgICAgICB0YWJsZS5zdHlsZS5oZWlnaHQgPSBcIjIwMHB4XCI7XHJcbiAgICAgICAgdGFibGUuc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcclxuICAgICAgICB0YWJsZS5pbnNlcnRBZGphY2VudEhUTUwoXCJhZnRlcmJlZ2luXCIsIGBcbiAgICAgICAgICAgIDxjYXB0aW9uIGNsYXNzPVwiZnctYm9sZCB0ZXh0LXByaW1hcnlcIj5cbiAgICAgICAgICAgICAgIEluZGV4IG9mIHRoZSBzdGF0ZSBpcyAke2FsbFN0YXRlc1tpbmRleE9mTmV4dFN0YXRlXS5pbmRleH1cbiAgICAgICAgICAgIDwvY2FwdGlvbj5cbiAgICAgICAgIGApO1xyXG4gICAgICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRib2R5XCIpO1xyXG4gICAgICAgIGZvciAobGV0IHJvdyBvZiBhbGxTdGF0ZXNbaW5kZXhPZk5leHRTdGF0ZV0uc3RhdGUpIHtcclxuICAgICAgICAgICAgY29uc3QgdGFibGVSb3cgPSB0Ym9keS5pbnNlcnRSb3coKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgY29sIG9mIHJvdykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGQgPSB0YWJsZVJvdy5pbnNlcnRDZWxsKCk7XHJcbiAgICAgICAgICAgICAgICB0ZC5jbGFzc0xpc3QuYWRkKFwiYWxpZ24tbWlkZGxlXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb2wpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZC5pbm5lckhUTUwgPSBcIiBcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRkLmlubmVySFRNTCA9IFN0cmluZyhjb2wpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhYmxlLmFwcGVuZENoaWxkKHRib2R5KTtcclxuICAgICAgICByZXN1bHRzV3JhcHBlcj8uYXBwZW5kQ2hpbGQodGFibGUpO1xyXG4gICAgICAgIHJlc3VsdHNXcmFwcGVyLnNjcm9sbFRvcCA9IHJlc3VsdHNXcmFwcGVyLnNjcm9sbEhlaWdodDtcclxuICAgICAgICAvLyBwcmludCByZXN1bHRzIHRvIHRoZSBjb25zb2xlXHJcbiAgICAgICAgZGlzcGxheUJvYXJkKGFsbFN0YXRlc1tpbmRleE9mTmV4dFN0YXRlXS5zdGF0ZSwgYWxsU3RhdGVzW2luZGV4T2ZOZXh0U3RhdGVdLmluZGV4KTtcclxuICAgICAgICBpbmRleE9mTmV4dFN0YXRlKys7XHJcbiAgICB9KTtcclxuICAgIHJlc3VsdEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBwcmludFJlc3VsdHMoKTtcclxuICAgIH0pO1xyXG4gICAgZmluZEJ1dHRvbj8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZpbmRSZXN1bHRzKTtcclxufSkoKTtcclxuIl0sIm5hbWVzIjpbImRpcmVjdGlvbnMiLCJ4IiwieSIsIm5hbWUiLCJDTEVBTl9SRVNVTFQiLCJjdXJyZW50U3RhdGUiLCJtb3ZlcyIsInNldHRsZWQiLCJkcm9wcGVkIiwiZGVwdGgiLCJoYXZlU29sdXRpb24iLCJkaXNwbGF5Qm9hcmQiLCJzdGF0ZSIsImluZGV4IiwiZGVidWciLCJjb25zb2xlIiwibG9nIiwiZGlzcGxheSIsInJvdyIsImNlbGxzIiwibWFwIiwiaXRlbSIsImdldEVtcHlDZWxsQ29vcmRzIiwiY29vcmRpbmF0ZXMiLCJvdXRlciIsImkiLCJsZW5ndGgiLCJqIiwiaXNPdXRPZkJvcmRlciIsImNvb3JkcyIsIk5vZGUiLCJjb25zdHJ1Y3RvciIsInBhcmVudCIsIm9wZXJhdG9yIiwiY29zdCIsInRoaXMiLCJnZXRTdGF0ZSIsImdldE1vdmVzIiwiZ2V0RGVwdGgiLCJwYXRoRnJvbVN0YXJ0Iiwic3RhdGVMaXN0IiwibW92ZUxpc3QiLCJjdXJyZW50Tm9kZSIsInB1c2giLCJyZXZlcnNlIiwiam9pbiIsInJlc3VsdHMiLCJhbGxTdGF0ZXMiLCJuZXh0U3RhdGVCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZXN1bHRCdXR0b24iLCJmaW5kQnV0dG9uIiwicmVzdWx0Q29udGVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5kZXhPZk5leHRTdGF0ZSIsInJlc3VsdHNXcmFwcGVyIiwiZGlzYWJsZWQiLCJhZGRFdmVudExpc3RlbmVyIiwidGFibGUiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwic3R5bGUiLCJ3aWR0aCIsImhlaWdodCIsInRleHRBbGlnbiIsImluc2VydEFkamFjZW50SFRNTCIsInRib2R5IiwidGFibGVSb3ciLCJpbnNlcnRSb3ciLCJjb2wiLCJ0ZCIsImluc2VydENlbGwiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lckhUTUwiLCJTdHJpbmciLCJhcHBlbmRDaGlsZCIsInNjcm9sbFRvcCIsInNjcm9sbEhlaWdodCIsImdldFRhYmxlU3RhdGUiLCJyb3dzIiwic3RhdGVSb3ciLCJjZWxsIiwiY2VsbERhdGEiLCJwYXJzZUludCIsIk51bWJlciIsImlzTmFOIiwiaW5pdGlhbFN0YXRlVGFibGUiLCJmaW5hbFN0YXRlVGFibGUiLCJpbml0aWFsIiwiZmluYWwiLCJkYiIsIk1hcCIsInNldCIsInRvU3RyaW5nIiwicXVldWUiLCJzdGF0ZXMiLCJwb3AiLCJzaXplIiwic2Vjb25kU3RhdGUiLCJlbXB0eUNlbGwiLCJmb3JFYWNoIiwiZGlyZWN0aW9uIiwiY29weVN0YXRlIiwiZ2V0IiwiREZTIl0sInNvdXJjZVJvb3QiOiIifQ==